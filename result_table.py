from result import get_result
from config import api_key, url
from upload import upload
import json

def result_table():
	#try:
		response = upload()
		if response.status_code == 200:
			report = get_result(api_key, response)
			analyze = {}
			

			file_name = ((report["data"])["attributes"]).get("meaningful_name", "unable to fetch ")
			sha_hash = ((report["data"])["attributes"])["sha256"]
			descp = ((report["data"])["attributes"])["type_description"]
			file_size = (((report["data"])["attributes"])["size"]) * 10**-3

			result = ((report["data"])["attributes"])["last_analysis_results"]

			for key, value in result.items():
				analyze[key] = [f"{key1} = {value1}" for key1, value1 in value.items() if value1 != key ]
			return analyze
	#except:
		#raise FileNotFoundError

def file_info():
	#try
		response = upload()
		if response.status_code == 200:
			report = get_result(api_key, response)
			file_info = {}

			file_name = ((report["data"])["attributes"]).get("meaningful_name", "unable to fetch ")
			sha_hash = ((report["data"])["attributes"])["sha256"]
			descp = ((report["data"])["attributes"])["type_description"]
			file_size = (((report["data"])["attributes"])["size"]) * 10**-3

			file_info['Name'] = [file_name]
			file_info['Hash'] = [sha_hash]
			file_info['File Type'] = [descp]
			file_info['File Size'] = [file_size]

		return file_info
	#except:
		#raise FileNotFoundError
